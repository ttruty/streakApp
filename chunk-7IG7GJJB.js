import{m as c}from"./chunk-33AMBPXS.js";var n=(()=>{let i=class i{constructor(){this.STORAGE_KEY="user_character_v1",this.MASTER_ACHIEVEMENTS=[{id:"streak_3",title:"Consistency is Key",description:"Reach a 3-day streak on any habit",type:"streak",targetValue:3,currentValue:0,xpReward:50,completed:!1,claimed:!1},{id:"streak_7",title:"Unstoppable",description:"Reach a 7-day streak on any habit",type:"streak",targetValue:7,currentValue:0,xpReward:150,completed:!1,claimed:!1},{id:"quest_10",title:"Busy Bee",description:"Complete 10 total quests",type:"count",targetValue:10,currentValue:0,xpReward:100,completed:!1,claimed:!1},{id:"collector_hammer",title:"Hammer Time",description:"Collect 3 Hammers",type:"collection",targetId:"hammer",targetValue:3,currentValue:0,xpReward:200,completed:!1,claimed:!1}],this.state={level:1,currentXp:0,maxXp:100,stats:{strength:10,intelligence:10,constitution:10,dexterity:10,charisma:10}},this.achievements=[],this.loadData()}loadData(){let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);this.state=e.state,this.achievements=e.achievements,this.MASTER_ACHIEVEMENTS.forEach(s=>{this.achievements.find(a=>a.id===s.id)||this.achievements.push(s)})}else this.achievements=[...this.MASTER_ACHIEVEMENTS],this.saveData()}saveData(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify({state:this.state,achievements:this.achievements}))}addXp(t){this.state.currentXp+=t,this.checkLevelUp(),this.saveData()}checkLevelUp(){this.state.currentXp>=this.state.maxXp&&(this.state.currentXp-=this.state.maxXp,this.state.level++,this.state.maxXp=Math.floor(this.state.maxXp*1.5),this.checkLevelUp())}notifyHabitComplete(t){this.achievements.filter(e=>e.type==="count"&&!e.completed).forEach(e=>{e.currentValue++,e.currentValue>=e.targetValue&&(e.completed=!0)}),this.achievements.filter(e=>e.type==="streak"&&!e.completed).forEach(e=>{t>e.currentValue&&(e.currentValue=t,e.currentValue>=e.targetValue&&(e.completed=!0))}),this.saveData()}notifyInventoryUpdate(t){this.achievements.filter(e=>e.type==="collection"&&!e.completed).forEach(e=>{let s=t.find(a=>a.id===e.targetId);s&&(e.currentValue=s.quantity,e.currentValue>=e.targetValue&&(e.completed=!0))}),this.saveData()}claimAchievement(t){let e=this.achievements.find(s=>s.id===t);return e&&e.completed&&!e.claimed?(e.claimed=!0,this.addXp(e.xpReward),this.saveData(),e.xpReward):0}modifyStat(t,e,s=!1){let a=0;switch(e){case"easy":a=.1;break;case"medium":a=.3;break;case"hard":a=.5;break}s&&(a=a*-1),this.state.stats[t]!==void 0&&(this.state.stats[t]=parseFloat((this.state.stats[t]+a).toFixed(1)),this.state.stats[t]<1&&(this.state.stats[t]=1),this.saveData())}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();export{n as a};
