import{m as c}from"./chunk-K64DFS7A.js";var n=(()=>{let a=class a{constructor(){this.STORAGE_KEY="user_character_v1",this.MASTER_ACHIEVEMENTS=[{id:"streak_3",title:"Consistency is Key",description:"Reach a 3-day streak on any habit",type:"streak",targetValue:3,currentValue:0,xpReward:50,completed:!1,claimed:!1},{id:"streak_7",title:"Unstoppable",description:"Reach a 7-day streak on any habit",type:"streak",targetValue:7,currentValue:0,xpReward:150,completed:!1,claimed:!1},{id:"quest_10",title:"Busy Bee",description:"Complete 10 total quests",type:"count",targetValue:10,currentValue:0,xpReward:100,completed:!1,claimed:!1},{id:"collector_hammer",title:"Hammer Time",description:"Collect 3 Hammers",type:"collection",targetId:"hammer",targetValue:3,currentValue:0,xpReward:200,completed:!1,claimed:!1}],this.state={level:1,currentXp:0,maxXp:100},this.achievements=[],this.loadData()}loadData(){let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);this.state=e.state,this.achievements=e.achievements,this.MASTER_ACHIEVEMENTS.forEach(i=>{this.achievements.find(r=>r.id===i.id)||this.achievements.push(i)})}else this.achievements=[...this.MASTER_ACHIEVEMENTS],this.saveData()}saveData(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify({state:this.state,achievements:this.achievements}))}addXp(t){this.state.currentXp+=t,this.checkLevelUp(),this.saveData()}checkLevelUp(){this.state.currentXp>=this.state.maxXp&&(this.state.currentXp-=this.state.maxXp,this.state.level++,this.state.maxXp=Math.floor(this.state.maxXp*1.5),this.checkLevelUp())}notifyHabitComplete(t){this.achievements.filter(e=>e.type==="count"&&!e.completed).forEach(e=>{e.currentValue++,e.currentValue>=e.targetValue&&(e.completed=!0)}),this.achievements.filter(e=>e.type==="streak"&&!e.completed).forEach(e=>{t>e.currentValue&&(e.currentValue=t,e.currentValue>=e.targetValue&&(e.completed=!0))}),this.saveData()}notifyInventoryUpdate(t){this.achievements.filter(e=>e.type==="collection"&&!e.completed).forEach(e=>{let i=t.find(r=>r.id===e.targetId);i&&(e.currentValue=i.quantity,e.currentValue>=e.targetValue&&(e.completed=!0))}),this.saveData()}claimAchievement(t){let e=this.achievements.find(i=>i.id===t);return e&&e.completed&&!e.claimed?(e.claimed=!0,this.addXp(e.xpReward),this.saveData(),e.xpReward):0}};a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{n as a};
