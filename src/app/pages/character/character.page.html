<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>

    <!-- Top Tabs -->
    <ion-segment
      value="stats"
      [(ngModel)]="selectedTab"
      (ionChange)="onTabChange($event)"
    >
      <ion-segment-button value="stats">
        <ion-label>Stats</ion-label>
      </ion-segment-button>

      <ion-segment-button value="achievements">
        <ion-label>Achievements</ion-label>
      </ion-segment-button>

      <ion-segment-button value="raider">
        <ion-label>Raider</ion-label>
      </ion-segment-button>
    </ion-segment>

  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <!-- ================= STATS VIEW ================= -->
  <ng-container *ngIf="selectedTab === 'raider'">
    <app-raider-customizer></app-raider-customizer>
  </ng-container>

    <ng-container *ngIf="selectedTab === 'stats'">

    <div class="hero-section">
      <div class="level-circle">
        <span class="lvl-label">Level {{ state.level }}</span>
      </div>

      <div class="xp-container">
        <div class="xp-text">
          <span>XP</span>
          <span>{{ state.currentXp }} / {{ state.maxXp }}</span>
        </div>

        <ion-progress-bar
          [value]="state.currentXp / state.maxXp"
          color="tertiary">
        </ion-progress-bar>
      </div>
    </div>

    <div class="stats-section">
      <h3>Attributes</h3>

      <div class="stats-grid">

      <div class="stat-card str" (click)="showStatDetails('strength')">
        <div class="stat-icon"><ion-icon name="barbell"></ion-icon></div>
        <div class="stat-info">
          <span class="stat-label">STRENGTH</span>
          <span class="stat-value">{{ state.stats.strength }}</span>
        </div>
      </div>

      <div class="stat-card int" (click)="showStatDetails('intelligence')">
        <div class="stat-icon"><ion-icon name="book"></ion-icon></div>
        <div class="stat-info">
          <span class="stat-label">INTELLIGENCE</span>
          <span class="stat-value">{{ state.stats.intelligence }}</span>
        </div>
      </div>

      <div class="stat-card con" (click)="showStatDetails('constitution')">
        <div class="stat-icon"><ion-icon name="heart"></ion-icon></div>
        <div class="stat-info">
          <span class="stat-label">CONSTITUTION</span>
          <span class="stat-value">{{ state.stats.constitution }}</span>
        </div>
      </div>

      <div class="stat-card dex" (click)="showStatDetails('dexterity')">
        <div class="stat-icon"><ion-icon name="flash"></ion-icon></div>
        <div class="stat-info">
          <span class="stat-label">DEXTERITY</span>
          <span class="stat-value">{{ state.stats.dexterity }}</span>
        </div>
      </div>

      <div class="stat-card cha" (click)="showStatDetails('charisma')">
        <div class="stat-icon"><ion-icon name="chatbubble"></ion-icon></div>
        <div class="stat-info">
          <span class="stat-label">CHARISMA</span>
          <span class="stat-value">{{ state.stats.charisma }}</span>
        </div>
      </div>
      </div>
    </div>

    <div class="achievements-section">
      <h3>Achievements</h3>

      <div
        *ngFor="let ach of achievements"
        class="ach-card"
        [class.completed]="ach.completed"
      >

        <div class="ach-header">
          <div class="ach-info">
            <h4>{{ ach.title }}</h4>
            <p>{{ ach.description }}</p>
          </div>

          <div class="xp-badge" *ngIf="!ach.claimed">
            +{{ ach.xpReward }} XP
          </div>

          <ion-icon
            name="checkmark-circle"
            color="success"
            *ngIf="ach.claimed">
          </ion-icon>
        </div>

        <div class="ach-progress" *ngIf="!ach.claimed">

          <ion-progress-bar
            [value]="ach.currentValue / ach.targetValue"
            [color]="ach.completed ? 'success' : 'primary'">
          </ion-progress-bar>

          <span class="progress-text">
            {{ ach.currentValue }} / {{ ach.targetValue }}
          </span>

        </div>

        <ion-button
          *ngIf="ach.completed && !ach.claimed"
          expand="block"
          color="success"
          size="small"
          (click)="claim(ach)">
          Claim Reward
        </ion-button>

      </div>

    </div>

  </ng-container>


  <!-- ================= ACHIEVEMENTS VIEW ================= -->
  <ng-container *ngIf="selectedTab === 'achievements'">

    <div class="achievements-section">
      <h3>Achievements</h3>

      <div
        *ngFor="let ach of achievements"
        class="ach-card"
        [class.completed]="ach.completed"
      >

        <div class="ach-header">
          <div class="ach-info">
            <h4>{{ ach.title }}</h4>
            <p>{{ ach.description }}</p>
          </div>

          <div class="xp-badge" *ngIf="!ach.claimed">
            +{{ ach.xpReward }} XP
          </div>

          <ion-icon
            name="checkmark-circle"
            color="success"
            *ngIf="ach.claimed">
          </ion-icon>
        </div>

        <div class="ach-progress" *ngIf="!ach.claimed">

          <ion-progress-bar
            [value]="ach.currentValue / ach.targetValue"
            [color]="ach.completed ? 'success' : 'primary'">
          </ion-progress-bar>

          <span class="progress-text">
            {{ ach.currentValue }} / {{ ach.targetValue }}
          </span>

        </div>

        <ion-button
          *ngIf="ach.completed && !ach.claimed"
          expand="block"
          color="success"
          size="small"
          (click)="claim(ach)">
          Claim Reward
        </ion-button>

      </div>

    </div>

  </ng-container>

</ion-content>
