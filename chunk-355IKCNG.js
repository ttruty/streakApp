import{m as o,x as n}from"./chunk-NZN4TXHG.js";import{a as l}from"./chunk-JHI3MBHO.js";var m=(()=>{let i=class i{constructor(){this.loadout=n(this.getInitialLoadout()),this.ASSET_LIBRARY={base:[{id:"male_raider",name:"Male Raider",modelUrl:"assets/raider_male.glb",thumbnail:"assets/thumbs/male.png"},{id:"female_raider",name:"Female Raider",modelUrl:"assets/raider_female.glb",thumbnail:"assets/thumbs/female.png"}],hat:[{id:"cowboy",name:"Cowboy Hat",modelUrl:"assets/cowboy.glb",thumbnail:"assets/thumbs/cowboy.png",scale:.15,offset:[0,21,0]},{id:"tophat",name:"Top Hat",modelUrl:"assets/tophat.glb",thumbnail:"assets/thumbs/tophat.png",scale:10,offset:[0,24,0]},{id:"pirate",name:"Pirate Hat",modelUrl:"assets/pirate.glb",thumbnail:"assets/thumbs/pirate.png",scale:4,offset:[0,15,0]},{id:"propeller",name:"Propeller Hat",modelUrl:"assets/propeller.glb",thumbnail:"assets/thumbs/propeller.png",scale:3,offset:[0,14,5]}],backpack:[{id:"jetpack",name:"Jetpack",modelUrl:"assets/jetpack.glb",thumbnail:"assets/thumbs/jet.png",scale:20,offset:[0,0,-20],rotation:[0,Math.PI/2,0]},{id:"rucksack",name:"Survival Bag",modelUrl:"assets/rucksack.glb",thumbnail:"assets/thumbs/bag.png",scale:50,offset:[0,0,-10],rotation:[0,Math.PI,0]},{id:"trash",name:"Trash Bag",modelUrl:"assets/trash.glb",thumbnail:"assets/thumbs/trash.png",scale:130,offset:[0,0,-10],rotation:[0,Math.PI,0]},{id:"pack",name:"Pack Bag",modelUrl:"assets/pack.glb",thumbnail:"assets/thumbs/pack.png",scale:20,offset:[0,0,-10],rotation:[0,Math.PI,0]}],item:[{id:"saber",name:"Light Saber",modelUrl:"assets/saber.glb",thumbnail:"assets/thumbs/saber.png",scale:200,offset:[20,10,0],rotation:[0,3*Math.PI/2,0]},{id:"sword",name:"Katana",modelUrl:"assets/sword.glb",thumbnail:"assets/thumbs/katana.png",scale:50,offset:[0,10,0],rotation:[0,0,3*Math.PI/2]},{id:"culver",name:"Ancient Saber",modelUrl:"assets/culver.glb",thumbnail:"assets/thumbs/culver.png",scale:100,offset:[0,10,0],rotation:[0,0,3*Math.PI/2]}]},this.currentLoadout={base:"assets/raider_male.glb",hat:void 0,backpack:void 0,item:void 0},this.STORAGE_KEY="user_character_v1",this.RAIDER_STORAGE_KEY="raider_loadout",this.MASTER_ACHIEVEMENTS=[{id:"streak_3",title:"Consistency is Key",description:"Reach a 3-day streak on any habit",type:"streak",targetValue:3,currentValue:0,xpReward:50,completed:!1,claimed:!1},{id:"streak_7",title:"Unstoppable",description:"Reach a 7-day streak on any habit",type:"streak",targetValue:7,currentValue:0,xpReward:150,completed:!1,claimed:!1},{id:"quest_10",title:"Busy Bee",description:"Complete 10 total quests",type:"count",targetValue:10,currentValue:0,xpReward:100,completed:!1,claimed:!1},{id:"collector_hammer",title:"Hammer Time",description:"Collect 3 Hammers",type:"collection",targetId:"hammer",targetValue:3,currentValue:0,xpReward:200,completed:!1,claimed:!1}],this.state={level:1,currentXp:0,maxXp:100,stats:{strength:10,intelligence:10,constitution:10,dexterity:10,charisma:10}},this.achievements=[],this.loadData()}getInitialLoadout(){let e=localStorage.getItem(this.RAIDER_STORAGE_KEY);return e?JSON.parse(e):null}getAssetDetails(e,t){return typeof t=="object"&&t!==null?t:this.ASSET_LIBRARY[e].find(a=>a.id===t||a.modelUrl===t)}setLoadout(e){this.currentLoadout=e,this.saveRaiderToStorage(),this.loadout.set(l({},e))}saveRaiderToStorage(){localStorage.setItem(this.RAIDER_STORAGE_KEY,JSON.stringify(this.currentLoadout))}loadRaiderFromStorage(){let e=localStorage.getItem(this.RAIDER_STORAGE_KEY);if(e)try{this.currentLoadout=JSON.parse(e)}catch(t){console.error("Error parsing saved loadout",t)}return this.currentLoadout}getLoadout(){return this.currentLoadout}loadData(){let e=localStorage.getItem(this.STORAGE_KEY);if(e){let t=JSON.parse(e);this.state=t.state,this.achievements=t.achievements,this.MASTER_ACHIEVEMENTS.forEach(s=>{this.achievements.find(a=>a.id===s.id)||this.achievements.push(s)})}else this.achievements=[...this.MASTER_ACHIEVEMENTS],this.saveData()}saveData(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify({state:this.state,achievements:this.achievements}))}addXp(e){this.state.currentXp+=e,this.checkLevelUp(),this.saveData()}checkLevelUp(){this.state.currentXp>=this.state.maxXp&&(this.state.currentXp-=this.state.maxXp,this.state.level++,this.state.maxXp=Math.floor(this.state.maxXp*1.5),this.checkLevelUp())}notifyHabitComplete(e){this.achievements.filter(t=>t.type==="count"&&!t.completed).forEach(t=>{t.currentValue++,t.currentValue>=t.targetValue&&(t.completed=!0)}),this.achievements.filter(t=>t.type==="streak"&&!t.completed).forEach(t=>{e>t.currentValue&&(t.currentValue=e,t.currentValue>=t.targetValue&&(t.completed=!0))}),this.saveData()}notifyInventoryUpdate(e){this.achievements.filter(t=>t.type==="collection"&&!t.completed).forEach(t=>{let s=e.find(a=>a.id===t.targetId);s&&(t.currentValue=s.quantity,t.currentValue>=t.targetValue&&(t.completed=!0))}),this.saveData()}claimAchievement(e){let t=this.achievements.find(s=>s.id===e);return t&&t.completed&&!t.claimed?(t.claimed=!0,this.addXp(t.xpReward),this.saveData(),t.xpReward):0}modifyStat(e,t,s=!1){let a=0;switch(t){case"easy":a=.1;break;case"medium":a=.3;break;case"hard":a=.5;break}s&&(a=a*-1),this.state.stats[e]!==void 0&&(this.state.stats[e]=parseFloat((this.state.stats[e]+a).toFixed(1)),this.state.stats[e]<1&&(this.state.stats[e]=1),this.saveData())}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();export{m as a};
