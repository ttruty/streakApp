import{m as l,x as h}from"./chunk-7WHQ53J5.js";import{a as u,b as m}from"./chunk-JHI3MBHO.js";var y=(()=>{let r=class r{constructor(){this.STORAGE_KEY="user_inventory",this.GOLD_KEY="user_gold",this.LOOT_TABLE={gold_coin:{id:"gold_coin",name:"Gold Coin",icon:"cash-outline",type:"material",description:"Currency.",sellValue:1,rarity:"common",quantity:1},diamond:{id:"diamond",name:"Diamond",icon:"diamond-outline",type:"material",description:"Sparkling gem.",sellValue:100,rarity:"legendary",quantity:1},potion:{id:"potion",name:"Potion",icon:"flask-outline",type:"consumable",description:"Restores health.",sellValue:15,rarity:"rare",quantity:1},shield:{id:"shield",name:"Shield",icon:"shield-outline",type:"equipment",description:"Protection.",sellValue:10,rarity:"common",quantity:1},hammer:{id:"hammer",name:"Iron Hammer",icon:"hammer-outline",type:"equipment",description:"Good for smashing.",sellValue:20,rarity:"common",quantity:1},key:{id:"key",name:"Mystery Key",icon:"key-outline",type:"material",description:"Opens something...",sellValue:50,rarity:"rare",quantity:1},map:{id:"map",name:"Old Map",icon:"map-outline",type:"consumable",description:"Reveals secrets.",sellValue:5,rarity:"common",quantity:1},herb:{id:"herb",name:"Magic Herb",icon:"leaf-outline",type:"material",description:"Medicinal plant.",sellValue:2,rarity:"common",quantity:1},skull:{id:"skull",name:"Cursed Skull",icon:"skull-outline",type:"material",description:"Spooky vibes.",sellValue:200,rarity:"legendary",quantity:1}}}getInventory(){let t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}getGold(){return parseInt(localStorage.getItem(this.GOLD_KEY)||"0",10)}addGold(t){let e=this.getGold();localStorage.setItem(this.GOLD_KEY,(e+t).toString())}addItem(t){let e=this.getInventory(),a=e.find(i=>i.id===t.id);a?a.quantity+=t.quantity:e.push(t),this.saveInventory(e)}removeItem(t,e=1){let a=this.getInventory(),i=a.findIndex(s=>s.id===t);i>-1&&(a[i].quantity-=e,a[i].quantity<=0&&a.splice(i,1),this.saveInventory(a))}generateLoot(t){let e=t==="high"?100:t==="medium"?50:10;this.addGold(e);let a=Math.random(),i=null;return a>.5&&(t==="low"&&(i=this.LOOT_TABLE.potion),t==="medium"&&(i=this.LOOT_TABLE.gem),t==="high"&&(i=this.LOOT_TABLE.sword)),i?(this.addItem(m(u({},i),{quantity:1})),{gold:e,item:i.name}):{gold:e,item:null}}saveInventory(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}getRandomItems(t,e){let a=Math.floor(Math.random()*(e-t+1))+t,i=[],s=Object.keys(this.LOOT_TABLE);for(let o=0;o<a;o++){let c=s[Math.floor(Math.random()*s.length)],d=u({},this.LOOT_TABLE[c]);d.id=d.id+"_"+Math.random().toString(36).substr(2,9),i.push(d)}return i}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var I=(()=>{let r=class r{constructor(){this.STORAGE_KEY="user_achievements_v1",this.MASTER_ACHIEVEMENTS=[{id:"quest_t1",groupId:"quest_chain",tier:1,title:"First Steps",description:"Complete your first quest",type:"count",targetValue:1,currentValue:0,xpReward:25,completed:!1,claimed:!1},{id:"quest_t2",groupId:"quest_chain",tier:2,title:"Getting Serious",description:"Complete 5 total quests",type:"count",targetValue:5,currentValue:0,xpReward:50,completed:!1,claimed:!1},{id:"quest_t3",groupId:"quest_chain",tier:3,title:"Quest Master",description:"Complete 10 total quests",type:"count",targetValue:10,currentValue:0,xpReward:150,completed:!1,claimed:!1},{id:"streak_t1",groupId:"streak_chain",tier:1,title:"Consistency",description:"Reach a 3-day streak",type:"streak",targetValue:3,currentValue:0,xpReward:50,completed:!1,claimed:!1},{id:"streak_t2",groupId:"streak_chain",tier:2,title:"Unstoppable",description:"Reach a 7-day streak",type:"streak",targetValue:7,currentValue:0,xpReward:150,completed:!1,claimed:!1},{id:"coll_hammer",groupId:"hammer_coll",tier:1,title:"Hammer Time",description:"Collect 1 Hammer",type:"collection",targetId:"hammer",targetValue:1,currentValue:0,xpReward:50,completed:!1,claimed:!1}],this.achievements=[],this.lastUnlocked=h(null),this.loadData()}getVisibleAchievements(){let t=[];return[...new Set(this.achievements.map(a=>a.groupId))].forEach(a=>{let s=this.achievements.filter(o=>o.groupId===a).sort((o,c)=>o.tier-c.tier).find(o=>!o.claimed);s&&t.push(s)}),t}getTrophyCase(){return this.achievements.filter(t=>t.claimed)}claim(t){let e=this.achievements.find(a=>a.id===t);return e&&e.completed&&!e.claimed?(e.claimed=!0,this.saveData(),e.xpReward):0}notifyHabitComplete(t){let e=!1,a=(i,s)=>{!i.completed&&s>=i.targetValue?(i.currentValue=s,i.completed=!0,this.lastUnlocked.set(i),e=!0):!i.completed&&s>i.currentValue&&(i.currentValue=s,e=!0)};this.achievements.filter(i=>i.type==="count").forEach(i=>{a(i,i.currentValue+1)}),this.achievements.filter(i=>i.type==="streak").forEach(i=>{a(i,t)}),e&&this.saveData()}notifyInventoryUpdate(t){this.achievements.filter(e=>e.type==="collection"&&!e.completed).forEach(e=>{let a=t.find(i=>i.id===e.targetId);a&&(e.currentValue=a.quantity,e.currentValue>=e.targetValue&&(e.completed=!0))}),this.saveData()}loadData(){let t=localStorage.getItem(this.STORAGE_KEY);t?(this.achievements=JSON.parse(t),this.MASTER_ACHIEVEMENTS.forEach(e=>{this.achievements.find(a=>a.id===e.id)||this.achievements.push(e)})):(this.achievements=JSON.parse(JSON.stringify(this.MASTER_ACHIEVEMENTS)),this.saveData())}saveData(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.achievements))}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();export{y as a,I as b};
