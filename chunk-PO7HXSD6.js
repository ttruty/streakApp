import{m as n}from"./chunk-NZN4TXHG.js";var d=(()=>{let i=class i{constructor(){this.STORAGE_KEY="user_habits",this.DATE_KEY="last_habit_date"}getHabits(){let e=localStorage.getItem(this.STORAGE_KEY);if(e)return JSON.parse(e);{let t=[{id:"default_water",title:"Drink Water",icon:"water",type:"regular",frequency:"daily",reward:"low",completed:!1,streak:0,history:[],associatedStat:"constitution",difficulty:"medium"}];return this.updateHabits(t),t}}addHabit(e){let t=this.getHabits();t.push(e),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}deleteHabit(e){let t=this.getHabits();t=t.filter(s=>s.id!==e),this.updateHabits(t)}updateHabits(e){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}completeHabit(e,t){let s=this.getHabits(),a=s.findIndex(r=>r.id===e);a>-1&&(s[a].completed=!0,s[a].streak++,s[a].history||(s[a].history=[]),s[a].history.push({date:new Date().toISOString(),mood:t}),this.updateHabits(s))}uncompleteHabit(e){let t=this.getHabits(),s=t.find(a=>a.id===e);s&&(s.completed=!1,s.streak>0&&s.streak--,this.updateHabits(t))}checkDateAndReset(){let e=new Date().toDateString(),t=localStorage.getItem(this.DATE_KEY);if(t===e)return;console.log("New Day Detected! Resetting habits...");let s=this.getHabits(),a=this.isYesterday(t);s.forEach(r=>{r.frequency==="daily"&&(r.completed&&a||r.completed||(r.streak=0)),r.completed=!1}),this.updateHabits(s),localStorage.setItem(this.DATE_KEY,e)}isYesterday(e){if(!e)return!1;let t=new Date;return t.setDate(t.getDate()-1),t.toDateString()===e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();export{d as a};
